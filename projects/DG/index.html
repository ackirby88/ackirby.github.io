<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>dg4est | Andrew Kirby, Ph.D.</title> <meta name="author" content="Andrew C. Kirby"/> <meta name="description" content="Learn more about high-order discretizations for the compressible Navier-Stokes equations with adaptive mesh refinement."/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/sphere.overset.tile.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="ackirby88.github.io/projects/DG/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Andrew Kirby, Ph.D.</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">research</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">dg4est</h1> <p class="post-description">Learn more about high-order discretizations for the compressible Navier-Stokes equations with adaptive mesh refinement.</p> </header> <article> <p>My primary research revolves around developing high-fidelity numerical methods for Computational Fluid Dynamics problems with applications to Wind Energy and Aerospace. This involves principally writing code de novo as the problems we target require leadership-class supercomputing capabilities. My research vision is to develop highly-scalable and highly-efficient algorithms coupling scientific computation with data-informed modeling suitable for leadership-class heterogeneous supercomputers and to facilitate industry-ready engineering simulations tools applicable to the fields of aerospace and renewable energy.</p> <p>The primary software I’ve developed over the past five years in <strong>dg4est</strong> which is a discontinuous Galerkin method leveraging the <a href="https://github.com/cburstedde/p4est" target="_blank" rel="noopener noreferrer">p4est</a> framework for managing and adapting the grid topology. <strong>dg4est</strong> is the primary off-body CFD solver within the <strong>WAKE3D</strong> framework and has been utilized in many applications. Some of the features of <strong>dg4est</strong> are outlined here.</p> <h2 id="dg4est">dg4est</h2> <ul> <li>2D and 3D Simulations <ul> <li>Cartesian and unstructured (high-order curvilinear) quad/hex meshes</li> <li> <a href="https://gmsh.info/" target="_blank" rel="noopener noreferrer">gmsh</a> mesh reader (binary, ascii): 2.X, 4.X formats</li> <li>Dynamic adaptive mesh refinement (non-conforming) with <a href="https://github.com/cburstedde/p4est" target="_blank" rel="noopener noreferrer">p4est</a> </li> </ul> </li> <li>High-Order Spatial Discretizations: Discontinous Galerkin <ul> <li>Nodal tensor-product basis functions: Lagrange polynomials (up to 24th order)</li> <li>Modal tensor-product basis functions: Legendre polynomials</li> <li>Quadrature Integration (collocation/over-integrable): Gauss-Legendre (2p+1 accuracy), Lobatto-Gauss (2p-1 accuracy)</li> <li>Kinetic energy-preserving scheme based on flux differencing: Pirozzoli, Kennedy &amp; Gruber</li> <li>Riemann solvers: Lax Friedrichs, Roe (with entropy fix)</li> <li>Diffusion solvers: SIP, BR2</li> <li>Governing equations <ul> <li>compressible Euler equations (inviscid)</li> <li>compressible Navier-Stokes equations (viscous)</li> </ul> </li> <li>LES subgrid-scale models <ul> <li>constant Smagorinsky</li> <li>dynamic Smagorinksy</li> <li>WALE</li> </ul> </li> <li>Sources: gravity, Coriolis</li> <li>Boundary conditions: free-stream, slip wall (symmetry), non-slip wall, characteristic, total inlet, static pressure outlet, periodic</li> </ul> </li> <li>High-Order Temporal Discretizations <ul> <li>Explicit Time Stepping <ul> <li>RK1: Forward Euler</li> <li>RK2: SSP (strong-stability preserving)</li> <li>RK3: SSP</li> <li>RK4: 3/8-rule</li> </ul> </li> <li>Implicit Time Stepping (dual time stepping: RK-optimized smoothers) <ul> <li>BDF-1</li> <li>BDF-2</li> <li>Space-Time DG (up to 10th order)</li> <li>Preconditioned FIRK 2-stage Gauss-Legendre</li> <li>Preconditioned FIRK 2-stage Radau IIA</li> </ul> </li> </ul> </li> <li>p-Multigrid Solution Convergence Acceleration (space-time, implicit, steady-state) <ul> <li>Full Approximation Scheme (FAS)</li> <li>V-/F-/W-Cycling</li> </ul> </li> <li>Acoustic Analysis <ul> <li>Ffowcs-Williams Hawkings (FW-H) acoustic-analogy formulation</li> </ul> </li> <li>Overset Simulation Infrastructure <ul> <li> <a href="https://github.com/jsitaraman/tioga" target="_blank" rel="noopener noreferrer">TIOGA</a> interface</li> </ul> </li> <li>In-situ Data Extraction <ul> <li>points, lines, planes, volumes</li> <li> <a href="https://www.visitusers.org/index.php?title=VisIt-tutorial-in-situ" target="_blank" rel="noopener noreferrer">VisIt Libsim</a> tnterface</li> <li> <a href="https://sensei-insitu.org/" target="_blank" rel="noopener noreferrer">SENSEI</a> interface</li> </ul> </li> <li>VTK Visualization <ul> <li>parallel VTU format (VisIt, paraview)</li> <li>High-order VTK Lagrange format (paraview)</li> </ul> </li> <li>Post-processing <ul> <li>LES SGS TKE</li> <li>Temporal statistics: mean, standard deviation, 95% confidence interval</li> <li>Reynolds stresses</li> <li>Proper Orthogonal Decomposition (POD)/Principal Component Analysis (PCA)</li> <li>MPI wall-clock time histogram viewer</li> <li>Analytical spatial error calculator (order of accuracy verification)</li> </ul> </li> <li>Unit Testing (gtest framework) and Regresion Testing</li> </ul> <h3 id="future-developments">Future Developments</h3> <ul> <li>Release the code as open source via GitHub!</li> <li>GPU Implementation using <a href="https://github.com/libocca" target="_blank" rel="noopener noreferrer">OCCA</a>: NVIDIA, AMD, Intel hardware <ul> <li>Full GPU offload including AMR (dynamic)</li> </ul> </li> <li>Mixed-element meshes (with AMR): tets, pyramids, prisms, hexes</li> <li>Boundary Representation (brep) incorporation for curved-mesh adaption</li> <li>Wall-Modeled Large Eddy Simulation</li> </ul> <h2>Unstructured High-Order Geometry</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/NACA0012.P3.Q2.Mach.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/NACA0012.P3.Q2.Mach.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/NACA0012.P3.Q2.Mach.gif-1400.webp"></source> <img src="/assets/img/NACA0012.P3.Q2.Mach.gif" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="3D NACA0012 curved grid." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2>Adaptive Mesh Refinement</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sphere.Re10000.vorticity.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sphere.Re10000.vorticity.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sphere.Re10000.vorticity.gif-1400.webp"></source> <img src="/assets/img/sphere.Re10000.vorticity.gif" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Sphere turbulent wake." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Adaptive mesh refinement allows for long turbulent wake tracking as illustrated in this flow over a sphere. </div> <h3 id="cartdg">CartDG</h3> <p><strong>dg4est</strong> utilizes a varible order <em>hp</em> discontinuous Galerkin implementation. The numerical FEM kernels in dg4est are carried over from my purely Cartesian DG solver known as CartDG. CartDG discretizes the compressible Navier–Stokes equations with Coriolis and gravitational forces. There are options for a constant or dynamic Smagorinsky Subgrid-Scale (SGS) Large Eddy Simulation (LES) model. The solver itself is designed for computational efficiency on Cartesian meshes and has been strong scaled to over 1 million MPI ranks on Argonne National Laboratory’s Mira Supercomputer as seen below.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/MIRA-scaling-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/MIRA-scaling-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/MIRA-scaling-1400.webp"></source> <img src="/assets/img/MIRA-scaling.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CartDG Mira scaling." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Strong scaling of the CartDG DG solver on Argonne's Mira supercomputer on over 1 million MPI ranks. </div> <p>To demonstrate the computational efficiency of CartDG, several performance statistics for a wide range of orders of solution accuracy are provided. The sustained peak performance of the inviscid and viscous residual evaluations is shown below on an Intel Core i7-5960X Haswell-E processor with eight CPU cores, clock speed of 3.0 GHz, 4 GB of memory per core, and a theoretical peak performance of 384 GFLOPS (TauBench benchmark 5.25 seconds). The tensor-product DG formulation achieves roughly 12% sustained compute peak performance for evaluation of the residual of the compressible Navier–Stokes equations (viscous residual) at high solution orders of accuracy.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/CartDG-Peak_ViscVsInviscid-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/CartDG-Peak_ViscVsInviscid-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/CartDG-Peak_ViscVsInviscid-1400.webp"></source> <img src="/assets/img/CartDG-Peak_ViscVsInviscid.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CartDG peak performance." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/CartDG-Peak_GeneralVsTensor-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/CartDG-Peak_GeneralVsTensor-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/CartDG-Peak_GeneralVsTensor-1400.webp"></source> <img src="/assets/img/CartDG-Peak_GeneralVsTensor.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CartDG performance comparison." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Sustained peak performance of CartDG for tensor-product basis formulations of viscous and inviscid equations for 2nd-16th order accuracy. Right: Sustained peak performance for tensor-product basis and general basis formulations of the Compressible Navier–Stokes Equations for 2nd-16th order accuracy. The general formulation operations are casted as Level 3 BLAS matrix–matrix products. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/CartDG-TimePerDOF_ViscVsInviscid-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/CartDG-TimePerDOF_ViscVsInviscid-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/CartDG-TimePerDOF_ViscVsInviscid-1400.webp"></source> <img src="/assets/img/CartDG-TimePerDOF_ViscVsInviscid.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CartDG peak performance." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/CartDG-TimePerDOF_GeneralVsTensor-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/CartDG-TimePerDOF_GeneralVsTensor-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/CartDG-TimePerDOF_GeneralVsTensor-1400.webp"></source> <img src="/assets/img/CartDG-TimePerDOF_GeneralVsTensor.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CartDG formulation comparison." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Time per degree-of-freedom of CartDG for viscous and inviscid equations for discretization orders of accuracy ranging from 2nd- to 24th-order (lower values are better). Comparison between the tensor-product and general formulations are shown, noting the former being nearly 10x faster at high orders of accuracy. </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Andrew C. Kirby. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Last updated: March 22, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>